{"name":"Wham","tagline":"Structural variant detection and association testing","body":"\r\n### What is WHAM?\r\n\r\nWHole-genome Alignment Metrics (WHAM) is a structural variant (SV) caller that integrates several sources of mapping information to identify SVs.  WHAM classifies SVs using a flexible and extendable machine-learning algorithm (random forest).  WHAM is not only accurate at identifying SVs, but its association test can identify shared SVs enriched in a cohort of diseased individuals compared to a background of healthy individuals.   \r\n\r\nWHAM can be easily run as a stand alone tool or as part of gkno (http://gkno.me) or bcbio-nextgen (http://bcbio-nextgen.readthedocs.org) pipelines.  \r\n\r\nCurrently we are preparing the WHAM manuscript.  If you would like to use and cite this tool, for the time being, please cite the WHAM github page.\r\n\r\n### Installing WHAM\r\n\r\nWHAM builds in two simple steps... assuming that you have the dependencies.  Most linux environments have cmake, and OpenMP the two requirements for WHAM.  If an install fails you might have to install a few libraries. \r\n\r\n### Fast and dirty install\r\n```\r\ngit clone --recursive https://github.com/jewmanchue/wham.git\r\ncd wham\r\ngit checkout v1.7.0\r\nmake\r\n```\r\n\r\n#### Dependencies\r\n\r\nFor classification of SV variant types **(OPTIONAL)**, a python distribution with the scikit-learn and argparse packages are required. These come standard with the Anaconda release of python, which can be obtained here:\r\n\r\nhttp://continuum.io/downloads\r\n\r\nIf you want to continue with your current python distribution use the following commands **(NOTE: requires Python (>= 2.6 or >= 3.3), NumPy (>= 1.6.1), SciPy (>= 0.9)**:\r\n\r\n```\r\npip install -U numpy scipy scikit-learn argparse\r\n```\r\n\r\nAfter dependency installation, clone the git repository with the following commands:\r\n\r\n```\r\ngit clone --recursive git@github.com:jewmanchue/wham.git\r\ncd wham\r\ngit checkout v1.7.0\r\nmake\r\n```\r\nIf you get an error while downloading wham try https:\r\n\r\n```\r\ngit clone --recursive https://github.com/jewmanchue/wham.git\r\ncd wham\r\ngit checkout v1.7.0\r\nmake\r\n```\r\n\r\nTo make sure you checked out the correct branch you should see v1.7.0 by typing:\r\n\r\n```\r\ngit name-rev --tags --name-only $(git rev-parse HEAD)\r\n```\r\n\r\n\r\n### WHAM input\r\n\r\nWHAM uses soft clipping information and supplementary alignments provided by mapping software. \r\nWe recommend that you use [BWA mem](http://bio-bwa.sourceforge.net) for accurate structural variant calls.  The input BAM files must be\r\nsorted, duplicates marked or removed and the BAM files need to be indexed.  The sorted\r\nBAM files need to have the HD:SO tag, this is provided by samtools 0.19 or later.  \r\n\r\n### Running WHAM\r\n\r\nusage statement:\r\n\r\n```\r\nusage  : WHAM-BAM -x <INT> -r <STRING>     -e <STRING>  -t <STRING>    -b <STRING>\r\n\r\nexample: WHAM-BAM -x 20    -r chr1:0-10000 -e genes.bed -t a.bam,b.bam -b c.bam,d.bam\r\n\r\nrequired: t <STRING> -- comma separated list of target bam files\r\noption  : b <STRING> -- comma separated list of background bam files\r\noption  : r <STRING> -- a genomic region in the format \"seqid:start-end\"\r\noption  : x <INT>    -- set the number of threads, otherwise max\r\noption  : e <STRING> -- a bedfile that defines regions to score\r\n\r\nVersion: v1.7.0-dirty\r\nContact: zev.kronenberg [at] gmail.com\r\nNotes  : -If you find a bug, please open a report on github!\r\n```\r\n\r\n#### Running on test data\r\n\r\nWe have supplied a test dataset for you to test your installation and get familiar with usage of WHAM. Try the following commands, run from the wham directory. Note that the commands scroll horizontally. \r\n\r\n```\r\n./bin/WHAM-BAM -t test/simulations/inv-5xsimA.sort.rmdup.chr22.bam > test/simulations/inv-5xsimA.sort.rmdup.chr22.test.vcf \r\npython utils/classify_WHAM_vcf.py test/simulations/inv-5xsimA.sort.rmdup.chr22.test.vcf utils/WHAM_training_data.txt > test/simulations/inv-5xsimA.sort.rmdup.chr22.CALLS.vcf\r\n```\r\nThe first command runs WHAM on your input BAM file and outputs an unsorted VCF file. The second command runs the WHAM classifier, which uses information from the SV calls and from a training dataset to classify each SV call (insertions, deletions, etc.).  After classification the output VCF file will have two new keys in the info field: \"WC\" and \"WP\".\r\n\r\n### Understanding WHAM output\r\n\r\nWHAM outputs an unsorted VCFv4.1 file.  Below is an example header.  \r\n\r\n```\r\n##fileformat=VCFv4.1\r\n##INFO=<ID=LRT,Number=1,Type=Float,Description=\"Likelihood Ratio Test Statistic\">\r\n##INFO=<ID=WAF,Number=3,Type=Float,Description=\"Allele frequency of: background,target,combined\">\r\n##INFO=<ID=GC,Number=2,Type=Integer,Description=\"Number of called genotypes in: background,target\">\r\n##INFO=<ID=AT,Number=15,Type=Float,Description=\"Attributes for classification\">\r\n##INFO=<ID=PU,Number=1,Type=Integer,Description=\"Number of reads read supporting position\">\r\n##INFO=<ID=SU,Number=1,Type=Integer,Description=\"Number of supplement read supporting position\">\r\n##INFO=<ID=CU,Number=1,Type=Integer,Description=\"Number of neighboring all soft clip clusters across all individuals at pileup position\">\r\n##INFO=<ID=SI,Number=1,Type=Float,Description=\"Shannon entropy\">\r\n##INFO=<ID=DP,Number=1,Type=Integer,Description=\"Number of reads at pileup position across individuals passing filters\">\r\n##INFO=<ID=SP,Number=1,Type=String,Description=\"Support for endpoint;  none:., mp:mate pair, sr:split read\">\r\n##INFO=<ID=BE,Number=3,Type=String,Description=\"Best end position: chr,position,count or none:.\">\r\n##INFO=<ID=DI,Number=1,Type=Character,Description=\"Consensus is from front or back of pileup : f,b\">\r\n##INFO=<ID=NC,Number=1,Type=String,Description=\"Number of soft clipped sequences collapsed into consensus\">\r\n##INFO=<ID=END,Number=1,Type=Integer,Description=\"End position of the variant described in this record\">\r\n##INFO=<ID=SVLEN,Number=1,Type=Integer,Description=\"Difference in length between REF and ALT allele\">\r\n##FORMAT=<ID=GT,Number=1,Type=String,Description=\"Genotype\">\r\n##FORMAT=<ID=GL,Number=A,Type=Float,Description=\"Genotype likelihood\">\r\n##FORMAT=<ID=NR,Number=1,Type=Integer,Description=\"Number of reads that do not support a SV\">\r\n##FORMAT=<ID=NA,Number=1,Type=Integer,Description=\"Number of reads supporting a SV\">\r\n##FORMAT=<ID=NS,Number=1,Type=Integer,Description=\"Number of reads with a softclip at POS for individual\">\r\n##FORMAT=<ID=RD,Number=1,Type=Integer,Description=\"Number of reads passing filters\">\r\n#CHROM  POS     ID      REF     ALT     QUAL    FILTER  INFO    FORMAT  NA12878.sorted.bam      NA12877.sorted.bam      NA12882.sorted.bam\r\n```\r\n\r\nHere is an unclassified wham example:\r\n```\r\n6\t\r\n131440530\r\n.\t\r\nN\t\r\nAGAGTAGAAAGTATCCTTATTTGGTTGGAAAGATCAGATGAAGGGGA\t\r\n.\r\n.\r\nLRT=0.3669;WAF=0.250001,0.500001,0.333334;GC=2,1;AT=0.853846,0,0,0,0.146154,0,0.0615385,0.146154,0,0.0846154,0,0,0,0,0,0,0.00769231;SI=1.81279;PU=22;SU=19;CU=140;RD=130;NC=18;SP=sr;BE=6,131440608,19;DI=b;END=131440608;SVLEN=78\t\r\nGT:GL:NR:NA:NS:RD\t\r\n0/1:-151.971,-24.2602,-331.572:24:11:11:35\t0/0:-4.5e-05,-255,-255:45:0:0:45\t0/1:-151.971,-29.1122,-428.281:31:11:11:42\r\n```\r\nThe first several columns should be familiar to most users as chrom, pos, ID, ref, alt, qual, filter.  The details for the info, format, and genotype fields can be found below.  The genotypes for the trio are 1/0, 0/0 and 0/1. \r\n\r\n\r\n====\r\n\r\nThe info field is comprised of ten key value pairs.\r\n\r\n#### LRT:\r\n\r\n  This is the likelihood ratio test statistic quantifying the difference in allele frequencies between the cases and controls.\r\n  If you are only using WHAM for its structural breakpoint detection this field will contain a -nan. Both  cases (target) and controls (background) bams must be specified using the -t & -b flags to get an LRT score.\r\n  \r\n#### WAF:\r\n\r\n  A comma separated list of allele frequencies of the background, target, combined. If control (background) bams were not specified the allele frequency for the background will be listed as -nan.  WHAM treats each breakpoint as a bi-allelic variant and estimates the frequency based on the genotype counts.\r\n  \r\n#### GC:\r\n\r\n  Wham does not call a genotype unless there are 3 reliable reads covering a position.  Genotypes of './.' are no-calls.  CG reports the number of genotypes that could be called reliably.\r\n  \r\n#### AT:\r\n\r\n This field used by wham to determine a classification.  There are 17 read depth normalized counts.  The average user should not worry about this field.\r\n \r\n#### SI:\r\n\r\n  Consensus sequence complexity measured by Shannon's entropy.  Wham removes calls where the entropy is below 0.5.\r\n  \r\n  \r\n#### PU:\r\n  \r\n  The number of primary mappings that support the exact breakpoint reported in the POS field. \r\n  \r\n#### SU:\r\n\r\n  The number of supplementary / split read support for the exact breakpoint reported in the POS field. \r\n  \r\n#### CU:\r\n\r\n  WHAM skips between positions that have soft-clipping.  There are some number of reads that cover a given soft-clipping position.  These reads can have soft-clipping at other locations.  The number of other positions where there are soft-clipping is reported at CU. \r\n  \r\n#### RD:\r\n\r\n  The number of reads covering all individuals joint called\r\n  \r\n  \r\n#### NC:\r\n  \r\n  The number of soft-clipped segments there were collapsed into the consensus sequence.\r\n  \r\n  \r\n#### SP:\r\n\r\n  Wham tries to identify the other breakpoint of an SV by first operating on split reads then mate pair mappings.\r\n  If the endpoint was identified by split reads the support tag will be 'sr', if the breakpoint was identified using mate pair mapping the support tag will be 'mp', otherwise the tag will be '.'.  \r\n  \r\n#### BE:\r\n\r\n  The best candidate endpoint based on split read clustering.\r\n  \r\n#### DI:\r\n  \r\n  This field denotes is the breakpoint is supported on the 5' of the pielup or 3' end of pileup.  The value 'f' denotes the '5 and 'b' denotes the 3'. \r\n  \r\n#### END:\r\n  \r\n  The end position of the structural variant.  If there is an interchromosomal SV this field will contain a '.'.\r\n  \r\n#### SVLEN:\r\n\r\n  The distance between the two breakpoints wham identified.   If there is an interchromosomal SV or the endpoint could not be identified this field will contain a '.'.\r\n  \r\n#### WC:\r\n\r\n  The class of structural variant classified by the random forest.\r\n  \r\n#### WP: \r\n\r\n  The probabilities for each class label generated by the random forest classifier.  \r\n  \r\n====  \r\n\r\nThe format field is comprised of six colon-delimited fields.\r\n\r\n####GT:\r\n  A genotype call.  The nature of the variant is unknown.  WHAM determines the zygosity.\r\n####GL:\r\n  log10 genotype likelihood under a bi-allelic model.\r\n####NR:\r\n  The number of reads that do not support any type of structural variant.\r\n####NA:\r\n  The number of reads that do support any type of structural variant.\r\n####NS:\r\n  The number of primary reads supporting with a soft clip at POS\r\n####RD:\r\n  The number of reads covering the individual at POS after filtering\r\n  \r\n","google":"UA-50580904-3","note":"Don't delete this file! It's used internally to help with page regeneration."}